<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>BENTO Admin Panel</title>

<script src="https://telegram.org/js/telegram-web-app.js"></script>

<style>
:root{
--bg:#0e0e11;--card:#1c1c22;--accent:#8774e1;--text:#fff;
--muted:#9aa0a6;--danger:#ff6b6b;--success:#4cd964;--warn:#ffcc00;
}
*{box-sizing:border-box;font-family:-apple-system,BlinkMacSystemFont}
body{margin:0;background:var(--bg);color:var(--text)}
#app{padding:16px}
.header{font-size:20px;font-weight:600;margin-bottom:16px}
.card{background:var(--card);border-radius:16px;padding:16px;margin-bottom:14px}
.user{font-size:14px;color:var(--muted)}
button{width:100%;padding:14px;margin-top:10px;border-radius:14px;border:none;background:var(--accent);color:#fff;font-size:16px}
.menu button{background:#2a2a33;text-align:left}
.exit{background:#2a1d1d;color:var(--danger)}
.back{color:var(--accent);margin-bottom:10px;cursor:pointer}
input{width:100%;padding:14px;border-radius:14px;border:none;background:#2a2a33;color:#fff;text-align:center}

/* watermark */
#watermark{position:fixed;bottom:10px;right:10px;opacity:.15;font-size:12px;pointer-events:none}

/* logs */
.log{padding:12px;border-radius:12px;margin-bottom:10px;font-size:14px}
.log.success{background:#1f2d24;color:var(--success)}
.log.warn{background:#2b2a1f;color:var(--warn)}
.log.danger{background:#2a1d1d;color:var(--danger)}
.log small{display:block;opacity:.6;font-size:11px;margin-top:4px}
</style>
</head>

<body>
<div id="app">–ó–∞–≥—Ä—É–∑–∫–∞‚Ä¶</div>

<script>
/* TELEGRAM ONLY */
if(!window.Telegram||!Telegram.WebApp){
document.body.innerHTML="<h2 style='color:red;text-align:center'>‚ùå –¢–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ Telegram</h2>";
throw new Error("No Telegram");
}
const tg=Telegram.WebApp;tg.expand();

/* SETTINGS */
const OWNER_IDS=[8354848795];
const PIN_CODE="2580";
const LOG_KEY="BENTO_LOGS";
const ADMIN_KEY="BENTO_ADMINS";

/* DATA */
const app=document.getElementById("app");
const user=tg.initDataUnsafe?.user;
let admins=JSON.parse(localStorage.getItem(ADMIN_KEY)||"[]");

/* ROLE */
let ROLE=null;
if(user){
if(OWNER_IDS.includes(user.id)) ROLE="OWNER";
else if(admins.includes(user.id)) ROLE="ADMIN";
}

/* LOGS */
function addLog(type,text){
const logs=JSON.parse(localStorage.getItem(LOG_KEY)||"[]");
logs.unshift({time:new Date().toLocaleString(),type,text,id:user?.id||"‚Äî",role:ROLE||"GUEST"});
localStorage.setItem(LOG_KEY,JSON.stringify(logs.slice(0,100)));
}

/* AUTO EXIT */
let idle;
function resetIdle(){
clearTimeout(idle);
idle=setTimeout(()=>{addLog("warn","‚è± –ê–≤—Ç–æ–≤—ã—Ö–æ–¥");tg.close()},180000);
}
["click","keydown","touchstart"].forEach(e=>document.addEventListener(e,resetIdle));
resetIdle();

/* ACCESS */
if(!user||!ROLE){
app.innerHTML=`
<div class="header">‚õî –ù–µ—Ç –¥–æ—Å—Ç—É–ø–∞</div>
<div class="card">
<div>ID: ${user?.id||"‚Äî"}</div>
<button onclick="location.reload()">üîÑ –û–±–Ω–æ–≤–∏—Ç—å</button>
</div>`;
addLog("warn","‚õî –í—Ö–æ–¥ –±–µ–∑ –ø—Ä–∞–≤");
throw new Error("No access");
}

addLog("success","üöÄ –í—Ö–æ–¥");
showPin();

/* PIN */
function showPin(){
app.innerHTML=`
<div class="header">üîê PIN</div>
<div class="card">
<input id="pin" type="password">
<button onclick="checkPin()">–í–æ–π—Ç–∏</button>
</div>`;
}
function checkPin(){
if(pin.value===PIN_CODE){
addLog("success","üîì PIN OK");
renderMain();addWatermark();
}else{addLog("danger","‚ùå PIN");alert("–ù–µ–≤–µ—Ä–Ω—ã–π PIN")}
}

/* WATERMARK */
function addWatermark(){
const wm=document.createElement("div");
wm.id="watermark";
wm.innerText=`BENTO ‚Ä¢ ${ROLE} ‚Ä¢ ID ${user.id}`;
document.body.appendChild(wm);
}

/* MAIN */
function renderMain(){
app.innerHTML=`
<div class="header">üëë BENTO ADMIN</div>
<div class="card">
<b>${user.first_name}</b>
<div class="user">ID: ${user.id}</div>
<div class="user">–†–æ–ª—å: ${ROLE}</div>
</div>
<div class="card menu">
<button onclick="openSection('–ó–∞—è–≤–∫–∏')">üì® –ó–∞—è–≤–∫–∏</button>
${ROLE==="OWNER"?`<button onclick="openAdmins()">üë• –ê–¥–º–∏–Ω—ã</button>`:""}
<button onclick="openLogs()">üìú –õ–æ–≥–∏</button>
<button class="exit" onclick="addLog('warn','üö™ –í—ã—Ö–æ–¥');tg.close()">üö™ –í—ã–π—Ç–∏</button>
</div>`;
}

/* ADMINS */
function openAdmins(){
app.innerHTML=`
<div class="back" onclick="renderMain()">‚Üê –ù–∞–∑–∞–¥</div>
<div class="header">üë• –ê–¥–º–∏–Ω—ã</div>
<div class="card">
<input id="newAdmin" placeholder="Telegram ID">
<button onclick="addAdmin()">‚ûï –î–æ–±–∞–≤–∏—Ç—å</button>
</div>
${admins.map(id=>`
<div class="card">
ID ${id}
<button class="exit" onclick="removeAdmin(${id})">‚ùå –£–¥–∞–ª–∏—Ç—å</button>
</div>`).join("")}`;
}
function addAdmin(){
const id=Number(newAdmin.value);
if(!admins.includes(id)){
admins.push(id);
localStorage.setItem(ADMIN_KEY,JSON.stringify(admins));
addLog("success","‚ûï –ê–¥–º–∏–Ω "+id);
openAdmins();
}}
function removeAdmin(id){
admins=admins.filter(a=>a!==id);
localStorage.setItem(ADMIN_KEY,JSON.stringify(admins));
addLog("warn","‚ùå –ê–¥–º–∏–Ω "+id);
openAdmins();
}

/* LOG UI */
function openLogs(){
const logs=JSON.parse(localStorage.getItem(LOG_KEY)||"[]");
app.innerHTML=`
<div class="back" onclick="renderMain()">‚Üê –ù–∞–∑–∞–¥</div>
<div class="header">üìú –õ–æ–≥–∏</div>
${logs.map(l=>`
<div class="log ${l.type}">
${l.text}
<small>${l.time} ‚Ä¢ ${l.role} ‚Ä¢ ID ${l.id}</small>
</div>`).join("")}`;
}

/* SECTIONS */
function openSection(name){
app.innerHTML=`
<div class="back" onclick="renderMain()">‚Üê –ù–∞–∑–∞–¥</div>
<div class="card">${name}<br>–í —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ</div>`;
}
</script>
</body>
</html>
