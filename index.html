<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>BENTO Admin Panel</title>

<script src="https://telegram.org/js/telegram-web-app.js"></script>

<style>
:root {
  --bg:#0e0e11;
  --card:#1c1c22;
  --accent:#8774e1;
  --text:#fff;
  --muted:#9aa0a6;
  --danger:#ff6b6b;
}

* {
  box-sizing:border-box;
  font-family:-apple-system,BlinkMacSystemFont;
}

body {
  margin:0;
  background:var(--bg);
  color:var(--text);
}

#app {
  padding:16px;
}

.header {
  font-size:20px;
  font-weight:600;
  margin-bottom:16px;
}

.card {
  background:var(--card);
  border-radius:16px;
  padding:16px;
  margin-bottom:14px;
}

.user {
  font-size:14px;
  color:var(--muted);
}

button {
  width:100%;
  padding:14px;
  margin-top:10px;
  border-radius:14px;
  border:none;
  background:var(--accent);
  color:white;
  font-size:16px;
}

.menu button {
  background:#2a2a33;
  text-align:left;
}

.exit {
  background:#2a1d1d;
  color:var(--danger);
}

.back {
  color:var(--accent);
  margin-bottom:10px;
  cursor:pointer;
}

input {
  width:100%;
  padding:16px;
  font-size:20px;
  border-radius:14px;
  border:none;
  background:#2a2a33;
  color:white;
  text-align:center;
  letter-spacing:6px;
}

/* üëÅÔ∏è WATERMARK */
#watermark {
  position:fixed;
  bottom:10px;
  right:10px;
  opacity:0.15;
  font-size:12px;
  pointer-events:none;
  z-index:9999;
}
</style>
</head>

<body>
<div id="app">–ó–∞–≥—Ä—É–∑–∫–∞‚Ä¶</div>

<script>
/* ================= üîí –£–†–û–í–ï–ù–¨ 1 ‚Äî –¢–û–õ–¨–ö–û TELEGRAM ================= */
if (!window.Telegram || !Telegram.WebApp) {
  document.body.innerHTML = `
    <h2 style="color:red;text-align:center;margin-top:40px">
      ‚ùå –î–æ—Å—Ç—É–ø –∑–∞–ø—Ä–µ—â—ë–Ω
    </h2>
    <p style="text-align:center">
      –û—Ç–∫—Ä–æ–π –ø–∞–Ω–µ–ª—å —Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ Telegram
    </p>
  `;
  throw new Error("Not Telegram");
}

/* ================= üïµÔ∏è‚Äç‚ôÇÔ∏è –£–†–û–í–ï–ù–¨ 2 ‚Äî –ê–ù–¢–ò-–û–¢–õ–ê–î–ö–ê ================= */
document.addEventListener("contextmenu", e => e.preventDefault());
document.addEventListener("selectstart", e => e.preventDefault());
document.addEventListener("keydown", e => {
  if (
    e.key === "F12" ||
    (e.ctrlKey && e.shiftKey) ||
    (e.ctrlKey && e.key === "u")
  ) {
    e.preventDefault();
  }
});

const tg = Telegram.WebApp;
tg.expand();

/* ===== –ù–ê–°–¢–†–û–ô–ö–ò ===== */
const OWNER_IDS = [8354848795];
const PIN_CODE = "2580";
/* ===================== */

const app = document.getElementById("app");
const user = tg.initDataUnsafe?.user;

/* ================= ‚è±Ô∏è –£–†–û–í–ï–ù–¨ 4 ‚Äî –ê–í–¢–û–í–´–•–û–î ================= */
let idleTimer;
function resetTimer() {
  clearTimeout(idleTimer);
  idleTimer = setTimeout(() => {
    tg.close();
  }, 3 * 60 * 1000); // 3 –º–∏–Ω—É—Ç—ã
}
["click","touchstart","keydown"].forEach(e =>
  document.addEventListener(e, resetTimer)
);
resetTimer();

/* ===== –ü–†–û–í–ï–†–ö–ê TELEGRAM ===== */
if (!user) {
  app.innerHTML = `
    <div class="header">‚ùå –û—à–∏–±–∫–∞</div>
    <div class="card">–û—Ç–∫—Ä–æ–π –ø–∞–Ω–µ–ª—å —á–µ—Ä–µ–∑ –∫–Ω–æ–ø–∫—É –≤ –±–æ—Ç–µ</div>
  `;
} else if (!OWNER_IDS.includes(Number(user.id))) {
  app.innerHTML = `
    <div class="header">‚õî –î–æ—Å—Ç—É–ø –∑–∞–ø—Ä–µ—â—ë–Ω</div>
    <div class="card">
      <div>ID: ${user.id}</div>
      <div>–ù–µ—Ç –ø—Ä–∞–≤ Owner</div>
    </div>
  `;
} else {
  showPin();
}

/* ===== PIN ===== */
function showPin() {
  app.innerHTML = `
    <div class="header">üîê –í–≤–µ–¥–∏—Ç–µ PIN</div>
    <div class="card">
      <input id="pin" type="password" inputmode="numeric" maxlength="6" />
      <button onclick="checkPin()">–í–æ–π—Ç–∏</button>
      <div id="error" style="color:#ff6b6b;margin-top:8px"></div>
    </div>
  `;
}

function checkPin() {
  const value = document.getElementById("pin").value;
  if (value === PIN_CODE) {
    renderMain();
    addWatermark(); // üëÅÔ∏è
  } else {
    document.getElementById("error").innerText = "–ù–µ–≤–µ—Ä–Ω—ã–π PIN";
  }
}

/* ================= üëÅÔ∏è –£–†–û–í–ï–ù–¨ 3 ‚Äî WATERMARK ================= */
function addWatermark() {
  const wm = document.createElement("div");
  wm.id = "watermark";
  wm.innerText = `BENTO ‚Ä¢ ID ${user.id}`;
  document.body.appendChild(wm);
}

/* ===== –ì–õ–ê–í–ù–û–ï –ú–ï–ù–Æ ===== */
function renderMain() {
  app.innerHTML = `
    <div class="header">üëë BENTO ADMIN</div>

    <div class="card">
      <b>${user.first_name}</b>
      <div class="user">ID: ${user.id}</div>
    </div>

    <div class="card menu">
      <button onclick="openSection('–ó–∞—è–≤–∫–∏')">üì® –ó–∞—è–≤–∫–∏</button>
      <button onclick="openSection('–ê–¥–º–∏–Ω—ã')">üë• –ê–¥–º–∏–Ω—ã</button>
      <button onclick="openSection('–ë–ª—ç–∫–ª–∏—Å—Ç')">‚õî –ë–ª—ç–∫–ª–∏—Å—Ç</button>
      <button onclick="openSection('–ù–∞—Å—Ç—Ä–æ–π–∫–∏')">‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏</button>
      <button class="exit" onclick="tg.close()">üö™ –í—ã–π—Ç–∏</button>
    </div>
  `;
}

window.openSection = function(name) {
  app.innerHTML = `
    <div class="back" onclick="renderMain()">‚Üê –ù–∞–∑–∞–¥</div>
    <div class="card">
      <b>${name}</b><br>
      –†–∞–∑–¥–µ–ª –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ
    </div>
  `;
};
</script>
</body>
</html>
